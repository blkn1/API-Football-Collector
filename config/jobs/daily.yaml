jobs:
  # Disabled by default to avoid assuming league/season/date targets.
  # Enable and fill params according to your tracked leagues/seasons.
  - job_id: "daily_standings"
    type: "incremental_daily"
    enabled: true
    priority: "HIGH"
    endpoint: "/standings"
    params:
      league: null
      season: null
    interval:
      type: "cron"
      cron: "0 1 * * *"  # Daily 01:00 UTC
    target_layer: "raw+core"
    dependencies:
      - "bootstrap_leagues"
      - "bootstrap_teams"
    coverage_target:
      endpoint: "/standings"
      league_id: null
      season: null
      min_records: 1
      max_lag_minutes: 1440

  - job_id: "daily_fixtures_by_date"
    type: "incremental_daily"
    enabled: true
    priority: "HIGH"
    endpoint: "/fixtures"
    params:
      date: null
    interval:
      type: "cron"
      cron: "0 * * * *"  # Hourly
    target_layer: "raw+core+mart"
  - job_id: "injuries_hourly"
    type: "incremental_daily"
    enabled: true
    priority: "HIGH"
    endpoint: "/injuries"
    params: {}
    interval:
      type: "cron"
      cron: "0 * * * *"  # Hourly (interpreted in SCHEDULER_TIMEZONE)
    target_layer: "raw+core"
    dependencies:
      - "bootstrap_leagues"
      - "bootstrap_teams"
    coverage_target:
      endpoint: "/injuries"
      min_records: 1
      max_lag_minutes: 120

  - job_id: "fixture_details_recent_finalize"
    type: "incremental_daily"
    enabled: true
    priority: "HIGH"
    endpoint: "/fixtures/*"
    params: {}
    interval:
      type: "cron"
      cron: "*/15 * * * *"  # Every 15 minutes (for lineup window + last-24h finalization)
    target_layer: "raw+core"
    dependencies:
      - "daily_fixtures_by_date"
    coverage_target:
      endpoint: "/fixtures/details"
      min_records: 1
      max_lag_minutes: 240

  - job_id: "fixture_details_backfill_90d"
    type: "incremental_daily"
    enabled: true  # Enabled for DB fill; bounded by FIXTURE_DETAILS_BACKFILL_BATCH.
    priority: "MEDIUM"
    endpoint: "/fixtures/*"
    params: {}
    interval:
      type: "cron"
      cron: "*/10 * * * *"  # Every 10 minutes, bounded by FIXTURE_DETAILS_BACKFILL_BATCH
    target_layer: "raw+core"
    dependencies:
      - "daily_fixtures_by_date"
    coverage_target:
      endpoint: "/fixtures/details_backfill_90d"
      min_records: 1
      max_lag_minutes: 1440

  # Backfill fixtures across seasons (quota-safe, resumeable via core.backfill_progress)
  - job_id: "fixtures_backfill_league_season"
    type: "incremental_daily"
    enabled: true
    priority: "MEDIUM"
    endpoint: "/fixtures"
    params: {}
    interval:
      type: "cron"
      cron: "* * * * *"  # every minute; bounded by BACKFILL_FIXTURES_MAX_TASKS_PER_RUN / BACKFILL_FIXTURES_MAX_PAGES_PER_TASK
    target_layer: "raw+core"
    coverage_target:
      endpoint: "/fixtures_backfill"
      min_records: 1
      max_lag_minutes: 1440

  # Backfill standings across seasons (quota-safe, resumeable via core.backfill_progress)
  - job_id: "standings_backfill_league_season"
    type: "incremental_daily"
    enabled: true
    priority: "LOW"
    endpoint: "/standings"
    params: {}
    interval:
      type: "cron"
      cron: "*/10 * * * *"  # every 10 minutes; bounded by BACKFILL_STANDINGS_MAX_TASKS_PER_RUN
    target_layer: "raw+core"
    coverage_target:
      endpoint: "/standings_backfill"
      min_records: 1
      max_lag_minutes: 1440


# Phase 3: Daily sync script configuration
# IMPORTANT: This does not enable scheduler jobs; it is used by scripts/daily_sync.py.
season: 2024
tracked_leagues:
  - id: 39
    name: "Premier League"
  - id: 140
    name: "La Liga"
  - id: 135
    name: "Serie A"
  - id: 61
    name: "Ligue 1"
  - id: 78
    name: "Bundesliga"

# Backfill configuration (fixtures + standings)
backfill:
  seasons: [2023, 2024, 2025]

